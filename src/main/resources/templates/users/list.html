<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{layout :: layout(~{::title}, ~{::section})}">
<head>
    <title>Users - Community</title>
</head>
<body>
<section>
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="mb-2">
                <i class="fas fa-users me-2"></i>Community Members
            </h1>
            <p class="text-muted">Discover and connect with other community members</p>
        </div>
        <div class="col-md-4 text-md-end">
            <span class="badge bg-primary fs-6" th:text="${#lists.size(users) + ' members'}">0 members</span>
        </div>
    </div>

    <!-- Search -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="input-group">
                <span class="input-group-text">
                    <i class="fas fa-search"></i>
                </span>
                <input type="text" class="form-control" placeholder="Search users..." id="searchInput">
            </div>
        </div>
        <div class="col-md-6">
            <select class="form-select" id="sortFilter">
                <option value="recent">Most Recent</option>
                <option value="active">Most Active</option>
                <option value="posts">Most Posts</option>
                <option value="likes">Most Liked</option>
            </select>
        </div>
    </div>

    <!-- Users Grid -->
    <div class="row" id="usersContainer">
        <div class="col-md-6 col-lg-4 mb-4" th:each="user : ${users}">
            <div class="card h-100 user-card">
                <div class="card-body text-center">
                    <!-- User Avatar -->
                    <div class="mb-3">
                        <img th:src="${user.profileImage}" alt="Profile" 
                             class="rounded-circle" width="80" height="80"
                             th:if="${user.profileImage != null}">
                        <i class="fas fa-user-circle fa-4x text-muted" th:unless="${user.profileImage != null}"></i>
                    </div>
                    
                    <!-- User Info -->
                    <h5 class="card-title mb-2" th:text="${user.nickname}">User Name</h5>
                    <p class="text-muted mb-3">
                        <i class="fas fa-calendar me-1"></i>
                        Member since <span th:text="${#temporals.format(user.createdAt, 'MMM yyyy')}">Date</span>
                    </p>
                    
                    <!-- User Stats -->
                    <div class="row text-center mb-3">
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="mb-0" th:text="${user.postCount}">0</h6>
                                <small class="text-muted">Posts</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="border-end">
                                <h6 class="mb-0" th:text="${user.totalLikes}">0</h6>
                                <small class="text-muted">Likes</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <h6 class="mb-0" th:text="${user.totalComments}">0</h6>
                            <small class="text-muted">Comments</small>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="d-grid gap-2">
                        <a th:href="@{/users/{id}(id=${user.id})}" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-user me-1"></i>View Profile
                        </a>
                        <a th:href="@{/posts?author=${user.id}}" class="btn btn-outline-secondary btn-sm">
                            <i class="fas fa-list me-1"></i>View Posts
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- No Users Message -->
    <div class="text-center py-5" th:if="${#lists.isEmpty(users)}">
        <i class="fas fa-users fa-3x text-muted mb-3"></i>
        <h4 class="text-muted">No users found</h4>
        <p class="text-muted">There are no users in the community yet.</p>
    </div>

    <!-- Pagination -->
    <nav th:if="${#lists.size(users) > 0}" aria-label="Users pagination">
        <ul class="pagination justify-content-center">
            <li class="page-item disabled">
                <a class="page-link" href="#" tabindex="-1">Previous</a>
            </li>
            <li class="page-item active">
                <a class="page-link" href="#">1</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">2</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">3</a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#">Next</a>
            </li>
        </ul>
    </nav>
</section>

<!-- JavaScript for search and filtering -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    const sortFilter = document.getElementById('sortFilter');
    const usersContainer = document.getElementById('usersContainer');
    
    // Search functionality
    searchInput.addEventListener('input', function() {
        filterUsers();
    });
    
    // Sort functionality
    sortFilter.addEventListener('change', function() {
        filterUsers();
    });
    
    function filterUsers() {
        const searchTerm = searchInput.value.toLowerCase();
        const sortBy = sortFilter.value;
        const userCards = usersContainer.querySelectorAll('.user-card');
        
        userCards.forEach(card => {
            const userName = card.querySelector('.card-title').textContent.toLowerCase();
            const matchesSearch = userName.includes(searchTerm);
            
            if (matchesSearch) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
        
        // Sort functionality (client-side sorting)
        const visibleCards = Array.from(userCards).filter(card => 
            card.style.display !== 'none'
        );
        
        // For now, just show all matching results
        // In a real implementation, you'd sort based on the selected criteria
    }
});
</script>
</body>
</html> 